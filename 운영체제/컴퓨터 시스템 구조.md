# 컴퓨터 시스템 구조

![img](https://media.vlpt.us/images/infoqoch/post/c380970b-14ae-4d07-a5de-b67dd5b60b82/1.jpg)

| 장치              | 설명                                                         |
| ----------------- | ------------------------------------------------------------ |
| Memory            | CPU 작업 공간                                                |
| device controller | 각 입출력 디바이스를 전담                                    |
| local buffer      | device controller의 작업 공간                                |
| register          | CPU 내부에 있으며 메모리보다 더 빠르게 정보 저장             |
| mode bit          | 현재 CPU에서 실행되는 것이 운영체제 커널인지 사용자 프로그램인지 명시 |
| interrupt line    | 인터럽트 발생 시 세팅됨, 인터럽트 발생 원인마다 라인이 다름  |
| timer             | 특정 프로그램이 CPU를 독점하는 것을 방지(time sharing 기능)  |

</br>

#### mode bit

* 0 : 커널 모드 ( = 모니터 모드, 시스템 모드)
  * 운영체제가 CPU에서 실행
  * 모든 명령 수행이 가능

- 1 : 사용자 모드
  - 사용자 프로그램이 CPU를 가지고 있음
  - 제한된 명령만 실행 가능


* interrupt가 들어오면 CPU 제어권이 운영체제에 넘어가면서 mode bit는 자동으로 0으로 바뀜

</br>

#### Timer

* 프로그램에 cpu를 넘겨줄 때  타이머에 시간을 할당해서 넘겨줌
* 타이머가 종료되면 interrupt를 걸어서 cpu를 다시 가져갈 있도록 함

</br>

#### Device Controller

* I/O 장치를 전담하는 일종의 작은 CPU(HW)
* 제어정보를 위한 control register, status register가 있음
* 데이터를 저장하는 local buffer를 가짐

* (cf) Device driver : os코드 중 각 장치별 처리루틴(SW)

</br>

#### DMA(Direct Memory Access)

* 직접 메모리에 접근할 수 있는 컨트롤러
* 원래는 CPU만이 메모리에 접근할 수 있지만 I/O장치의 잦은 interrupt로 CPU가 방해를 받는 경우 이것을 막기 위해 CPU에 접근함
  * CPU가 실행 중인 동안 I/O 장치로부터 들어온 interrupt 내용을 메모리에 카피해두고 일정한 양의 인터럽트가 끝나면 그제서야 CPU에 인터럽트를 걸어줌 => CPU의 인터럽트 처리 빈도가 낮아짐
  * CPU 중재 없이 device controller가 device의 buffer storage 내용을 바이트 단위가 아닌 block 단위로 전송
* CPU와 DMA 가 동시에 메모리에 접근하는 것을 방지하기 위해 Memory Controller를 가짐